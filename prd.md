# 产品报价系统 Web版 PRD

## 1. 产品概述
本报价系统是基于Web技术实现的项目报价管理平台，采用"硬成本+软成本占合同金额54%"的约束机制，提供完整的项目报价计算模型和工作流管理功能。系统支持销售、交付及财务团队在线协同工作，快速生成准确、可落地的项目报价方案，并实现报价全生命周期的追踪和管理。系统采用前后端分离架构，确保各功能模块可独立配置、扩展和维护。

## 2. 产品目标
- **准确性**：确保报价计算逻辑严谨，成本覆盖全面，避免漏项
- **灵活性**：支持参数配置（如成本比例、单价），适应不同项目类型和特殊审批
- **可操作性**：提供直观的Web界面和清晰的操作流程，便于各角色快速上手使用
- **可审计性**：记录关键决策（如复用比例）的审批流程和操作日志，满足审计要求
- **效率性**：通过实时计算、在线审批和数据共享，大幅提升报价生成和审核效率
- **协同性**：支持多角色在线协同工作，实现报价信息的实时同步和共享
- **可扩展性**：基于Web架构支持功能扩展和系统集成，满足未来业务发展需求

## 3. 需求范围

### 3.1 核心功能需求

#### 3.1.1 报价公式计算
| 功能点 | 需求描述 | 灵活性要求 | Web特性增强 |
|-------|---------|-----------|------------|
| 合同金额计算 | 基于公式：合同金额（含税）=（硬成本+软成本）÷ 约束比例 | 约束比例可配置（默认54%，支持CEO特批调整） | 实时计算，输入变化时自动更新结果 |
| 利润结构分解 | 合同金额 = 硬+软成本 + 风险金 + 管理公摊 + 利润及税差 | 各利润组件比例可独立调整 | 可视化展示利润结构占比，支持图表查看 |

#### 3.1.2 硬成本管理
| 成本科目 | 计算规则 | 配置项 | Web特性增强 |
|---------|---------|--------|------------|
| 现场人员成本 | 按档位×人数×月数计算（2.0万/人·月或1.8万/人·月） | 支持多档位配置，可新增/删除档位 | 人员档位下拉选择，支持批量添加/删除人员配置 |
| 房租 | 普通城市3000元/月·套；北上4000元/月·套 | 支持城市分类管理，租金标准可配置 | 城市搜索选择，自动匹配租金标准，支持批量录入 |
| 补助 | 60元/人·日（按自然日计算，含周末） | 补助标准可配置，计算规则可调整 | 日期范围选择器，自动计算天数，实时更新补助成本 |
| 差旅 | 1200元/人·月（包干制） | 差旅标准可配置，支持按项目类型调整 | 项目类型下拉选择，自动匹配差旅标准 |

#### 3.1.3 软成本管理
| 功能点 | 需求描述 | 灵活性要求 | Web特性增强 |
|-------|---------|-----------|------------|
| 定制开发成本 | 按档位×定制人月计算 | 与现场人员档位保持一致或独立配置 | 自动同步现场人员档位，支持手动调整 |
| 产品复用管理 | 软成本 = 定制成本 × (1-复用比例) | 复用比例范围可配置（0-100%），支持审批流程 | 滑块组件设置复用比例，实时计算软成本，支持审批意见录入 |

#### 3.1.4 管理及风险成本
| 成本科目 | 计算规则 | 配置项 | Web特性增强 |
|---------|---------|--------|------------|
| 管理公摊 | 合同金额×比例（默认3%） | 公摊比例可配置 | 实时计算，支持配置不同项目类型的公摊比例 |
| 风险准备金 | 合同金额×比例（默认3%） | 风险金比例可配置，支持项目级调整 | 实时计算，支持根据项目风险等级动态调整比例 |

### 3.2 数据管理需求

#### 3.2.1 项目基本信息管理
- 项目编号自动生成，支持自定义修改
- 项目名称、客户信息、项目类型等基础信息录入
- 人员档位选择（与成本单价关联）
- 项目周期（月数/天数）选择，支持日期范围输入
- **Web特性**：表单验证、自动保存草稿、历史版本对比

#### 3.2.2 成本数据管理
- 支持在线填写和修改各项成本数据
- 实时计算并展示硬成本小计、软成本小计和硬软合计
- 数据验证规则（如人数≥0，月数≥0，比例在0-100%之间）
- 成本数据变更记录和审计日志
- **Web特性**：输入提示、实时计算、错误提示、批量导入/导出Excel

#### 3.2.3 审批流程管理
- 产品复用比例审批：产品负责人+架构师双签流程
- 约束比例调整审批：CEO特批流程
- 报价最终审批：财务审核流程
- 审批意见在线录入和查看
- 审批状态实时更新和通知
- **Web特性**：待办事项提醒、审批流程图展示、电子签名支持

### 3.3 文档和报表管理

#### 3.3.1 报价单生成
- 自动生成标准化报价单文档
- 支持自定义报价单模板
- 包含完整成本结构和利润分析
- **Web特性**：在线预览、PDF导出、邮件发送

#### 3.3.2 成本分析报表
- 硬成本/软成本占比分析
- 项目利润结构分析
- 历史报价对比分析
- 成本趋势分析
- **Web特性**：图表可视化、数据钻取、报表导出

#### 3.3.3 操作日志
- 记录所有用户操作和数据变更
- 支持按项目、时间、用户筛选查询
- 满足审计要求
- **Web特性**：日志查询界面、导出功能

## 4. 非功能需求

### 4.1 灵活性
- 支持新增/删除成本科目，配置自定义计算规则
- 支持不同项目类型的参数配置模板
- 支持角色权限的灵活配置

### 4.2 易用性
- 操作步骤≤3步完成报价生成
- 提供直观的用户界面和清晰的操作指引
- 字段级帮助提示，提供在线帮助文档
- 响应式设计，支持桌面和移动设备访问
- 支持快捷键操作，提升操作效率

### 4.3 性能要求
- 页面加载时间≤2秒
- 报价计算响应时间≤500毫秒
- 支持至少100个并发用户
- 数据导出时间≤10秒（1000条记录以内）

### 4.4 安全性要求
- 用户认证：基于角色的访问控制（RBAC）
- 数据加密：传输层（HTTPS）和存储层加密
- 操作日志：记录所有关键操作，支持审计追踪
- 数据备份：每日自动备份，支持数据恢复
- 防止SQL注入、XSS等常见Web安全攻击

### 4.5 兼容性要求
- 支持主流浏览器：Chrome（最新版）、Firefox（最新版）、Safari（最新版）、Edge（最新版）
- 支持Windows、macOS、Linux等主流操作系统
- 支持移动端浏览器访问（iOS Safari、Android Chrome）

### 4.6 可扩展性
- 前后端分离架构，支持独立扩展
- 提供RESTful API，支持与CRM/ERP系统集成
- 支持多部门数据联动和共享
- 支持未来增加成本分析报表、预测分析等功能

### 4.7 可维护性
- 代码模块化，文档齐全
- 支持配置热更新，无需重启服务
- 提供监控和告警机制
- 支持灰度发布和版本回滚

### 4.8 准确性
- 计算结果100%符合公式逻辑
- 数据验证规则覆盖率100%
- 支持历史数据对比验证
- 提供计算过程的可视化展示，便于核对

## 5. 用户角色与权限

| 角色 | 主要职责 | 系统权限 | Web特性增强 |
|-----|---------|---------|------------|
| 销售 | 售前报价生成 | 查看模板、录入基础数据、生成初步报价、提交审批 | 待办事项提醒、报价草稿自动保存、历史报价查询 |
| 交付经理 | 成本确认与调整 | 修改实际档位、确认复用比例、调整成本数据、提交审核 | 成本数据批量修改、与销售在线沟通、审批流程追踪 |
| 产品负责人 | 复用比例审批 | 查看报价详情、确认产品复用比例、签署审批意见 | 在线审批、审批意见录入、审批历史查询 |
| 财务 | 成本审计与核算 | 查看完整成本结构、审核报价合理性、生成财务报表、导出数据 | 成本分析图表、审计日志查看、与其他角色在线协作 |
| CEO | 特殊参数审批 | 调整约束比例等核心参数、查看关键指标报表 | 审批提醒、关键参数调整记录、系统配置管理 |
| 系统管理员 | 系统维护与配置 | 用户管理、角色权限配置、参数配置、数据备份 | 系统监控面板、用户活动日志、配置热更新 |

## 6. 业务流程

### 6.1 售前报价流程
1. **创建报价单**：销售登录系统，创建新报价单，填写项目编号、名称、客户信息等基础数据
2. **成本录入**：销售选择人员档位、人数、周期等，系统实时计算硬成本和软成本（默认复用比例0%）
3. **生成初步报价**：系统基于约束比例自动生成初步合同金额和利润结构
4. **提交审批**：销售确认报价信息后，提交给交付经理审核，系统发送审批通知
5. **Web特性**：自动保存草稿、实时计算、表单验证、审批状态追踪

### 6.2 合同谈判流程
1. **交付经理审核**：交付经理收到审批通知，登录系统查看报价详情，确认或修改实际人员档位、项目周期等
2. **复用比例审批**：交付经理提交报价给产品负责人，产品负责人审核并确认产品复用比例，系统实时更新软成本
3. **财务审核**：复用比例确认后，报价自动流转到财务，财务审核成本结构和利润合理性
4. **特殊审批**：若需调整约束比例，提交CEO特批，系统记录审批意见和调整记录
5. **最终确认**：所有审核通过后，系统生成正式报价单，发送通知给相关角色
6. **Web特性**：在线审批、审批意见录入、实时成本更新、审批流程图可视化、补充协议自动生成

### 6.3 项目执行与监控流程
1. **项目账建立**：财务基于审核通过的报价单，自动建立项目成本账
2. **成本监控**：系统支持录入月度实际成本，自动与预测成本对比，生成差异分析
3. **变更管理**：若实际成本超出预测>3%，系统自动触发变更流程，更新报价并重新审批
4. **风险金分配**：项目验收后，系统自动计算未动用的风险金，按规则分配并生成报表
5. **Web特性**：实时成本监控仪表盘、变更流程自动触发、风险金分配可视化、项目历史数据查询

### 6.4 数据统计与分析流程
1. **报表生成**：系统支持生成各类报表，如报价汇总表、成本分析表、利润结构表等
2. **数据分析**：提供图表可视化功能，支持按时间、项目类型、部门等维度分析数据
3. **导出与共享**：报表支持导出Excel/PDF格式，可分享给相关角色
4. **Web特性**：自定义报表、图表可视化、数据钻取、定时报表生成

## 7. 验收标准

### 7.1 功能验收
- 报价公式计算结果准确无误，与手动计算结果一致
- 各成本科目取数和计算符合规则，实时更新
- 复用比例调整后软成本自动更新，计算逻辑正确
- 约束比例调整后合同金额重新计算，影响范围正确
- 审批流程完整，各角色权限控制有效
- 报表生成准确，数据导出功能正常

### 7.2 性能验收
- 页面加载时间≤2秒（模拟100Mbps网络环境）
- 报价计算响应时间≤500毫秒
- 支持100个并发用户同时操作，系统稳定
- 数据导出时间≤10秒（1000条记录）

### 7.3 安全性验收
- 用户认证和授权功能正常，权限控制有效
- 数据传输采用HTTPS加密
- 操作日志记录完整，可追踪关键操作
- 防止SQL注入、XSS等常见Web安全攻击

### 7.4 兼容性验收
- 在Chrome、Firefox、Safari、Edge最新版浏览器上功能正常
- 在Windows、macOS、Linux操作系统上运行正常
- 在移动端浏览器上可正常访问和操作

### 7.5 易用性验收
- 销售可在10分钟内完成初步报价生成
- 交付经理可独立完成成本调整和复用比例确认
- 财务可直接导出符合审计要求的报表
- 用户界面直观，操作流程清晰，无需培训即可上手

### 7.6 灵活性验收
- 可成功新增成本科目并配置自定义计算规则
- 可调整约束比例和各项成本单价，影响范围正确
- 支持不同项目类型的模板定制和参数配置
- 角色权限可灵活配置和调整

## 8. 风险与约束

### 8.1 已知约束
- 约束比例调整需CEO特批，系统记录审批流程
- 产品复用比例需产品负责人+架构师双签，系统保留电子签名记录
- 成本变化>合同金额3%时需签补充协议，系统自动生成协议模板
- 系统支持主流浏览器，不保证所有旧版本浏览器的兼容性
- 移动端仅支持基本功能，复杂操作建议在桌面端完成

### 8.2 潜在风险
- 人员档位频繁调整可能影响成本计算准确性，需加强审批控制
- 产品复用比例评估主观性较强，需建立量化评估标准
- 项目周期延长可能导致硬成本超支，系统需加强监控和预警
- Web系统依赖网络环境，需确保网络稳定性或提供离线功能预案
- 数据安全风险，需加强加密和访问控制
- 系统集成复杂度，需确保与现有CRM/ERP系统的兼容性

## 9. 附录

### 9.1 术语定义
- **硬成本**：交付侧必发生的成本，包括现场人员成本、房租、补助、差旅
- **软成本**：定制开发成本，按产品复用比例分摊
- **约束比例**：硬成本+软成本占合同金额的比例（默认54%）
- **复用比例**：产品可复用部分占定制开发的比例（0-100%）
- **RBAC**：基于角色的访问控制，用于系统权限管理
- **RESTful API**：用于系统间数据交互的接口规范
- **响应式设计**：使系统在不同设备上都能良好显示的设计方法
- **实时计算**：输入数据变化时立即更新计算结果的功能

### 9.2 计算公式汇总
- 合同金额（含税）=（硬成本+软成本）÷ 约束比例
- 硬成本小计 = 现场人员成本 + 房租 + 补助 + 差旅
- 现场人员成本 = 档位单价 × 人数 × 月数
- 房租成本 = 城市租金标准 × 套数 × 月数
- 补助成本 = 补助标准 × 人数 × 天数
- 差旅成本 = 差旅标准 × 人数 × 月数
- 软成本小计 = 定制开发人月 × 档位单价 × (1-复用比例)
- 管理公摊 = 合同金额 × 管理公摊比例
- 风险金 = 合同金额 × 风险金比例
- 利润及税差 = 合同金额 - 硬软合计 - 管理公摊 - 风险金

### 9.3 Web技术栈建议
- **前端**：React/Vue.js + Ant Design/Element UI
- **后端**：Spring Boot/Node.js + MySQL/PostgreSQL
- **认证授权**：JWT + Spring Security/Passport.js
- **报表生成**：ECharts + JasperReports
- **部署**：Docker + Kubernetes

### 9.4 数据字典（核心字段）
- **项目表**：项目ID、名称、客户ID、类型、状态、创建人、创建时间
- **成本表**：成本ID、项目ID、科目类型、金额、计算规则、创建时间
- **审批表**：审批ID、项目ID、审批人ID、审批角色、审批状态、审批意见、审批时间
- **用户表**：用户ID、姓名、角色、部门、联系方式、创建时间